{
  "$comment": "Invalid Issue() input golden vectors for cross-language conformance (v0.9.29+)",
  "version": "0.9.29",
  "runner_contract": {
    "input_format": "untyped JSON values passed to Issue()",
    "float_handling": "runner decodes amt as any/interface{}, Issue() validates integer constraint",
    "evidence_validation": "JSON-safe only; non-finite number tests are language-specific unit tests"
  },
  "fixtures": [
    {
      "id": "issue-invalid-001",
      "name": "missing-issuer",
      "description": "Missing required issuer field",
      "input": {
        "aud": "https://agent.example",
        "amt": 1000,
        "cur": "USD",
        "rail": "stripe",
        "reference": "ch_abc123"
      },
      "expected": {
        "valid": false,
        "error_code": "E_MISSING_REQUIRED_FIELD",
        "error_field": "iss"
      }
    },
    {
      "id": "issue-invalid-002",
      "name": "missing-audience",
      "description": "Missing required audience field",
      "input": {
        "iss": "https://publisher.example",
        "amt": 1000,
        "cur": "USD",
        "rail": "stripe",
        "reference": "ch_abc123"
      },
      "expected": {
        "valid": false,
        "error_code": "E_MISSING_REQUIRED_FIELD",
        "error_field": "aud"
      }
    },
    {
      "id": "issue-invalid-003",
      "name": "http-issuer",
      "description": "HTTP issuer URL not allowed (must be HTTPS)",
      "input": {
        "iss": "http://publisher.example",
        "aud": "https://agent.example",
        "amt": 1000,
        "cur": "USD",
        "rail": "stripe",
        "reference": "ch_abc123"
      },
      "expected": {
        "valid": false,
        "error_code": "E_INVALID_URL",
        "error_field": "iss"
      }
    },
    {
      "id": "issue-invalid-004",
      "name": "http-audience",
      "description": "HTTP audience URL not allowed (must be HTTPS)",
      "input": {
        "iss": "https://publisher.example",
        "aud": "http://agent.example",
        "amt": 1000,
        "cur": "USD",
        "rail": "stripe",
        "reference": "ch_abc123"
      },
      "expected": {
        "valid": false,
        "error_code": "E_INVALID_URL",
        "error_field": "aud"
      }
    },
    {
      "id": "issue-invalid-005",
      "name": "lowercase-currency",
      "description": "Currency must be uppercase",
      "input": {
        "iss": "https://publisher.example",
        "aud": "https://agent.example",
        "amt": 1000,
        "cur": "usd",
        "rail": "stripe",
        "reference": "ch_abc123"
      },
      "expected": {
        "valid": false,
        "error_code": "E_INVALID_CURRENCY",
        "error_field": "cur"
      }
    },
    {
      "id": "issue-invalid-006",
      "name": "negative-amount",
      "description": "Amount must be non-negative",
      "input": {
        "iss": "https://publisher.example",
        "aud": "https://agent.example",
        "amt": -100,
        "cur": "USD",
        "rail": "stripe",
        "reference": "ch_abc123"
      },
      "expected": {
        "valid": false,
        "error_code": "E_INVALID_AMOUNT",
        "error_field": "amt"
      }
    },
    {
      "id": "issue-invalid-007",
      "name": "float-amount",
      "description": "Amount must be integer (minor units) - runner passes decoded float64 to Issue()",
      "input": {
        "iss": "https://publisher.example",
        "aud": "https://agent.example",
        "amt": 99.99,
        "cur": "USD",
        "rail": "stripe",
        "reference": "ch_abc123"
      },
      "expected": {
        "valid": false,
        "error_code": "E_INVALID_AMOUNT",
        "error_field": "amt",
        "note": "Runner decodes to float64/any, Issue() checks for integer"
      }
    },
    {
      "id": "issue-invalid-008",
      "name": "missing-rail",
      "description": "Missing required rail field",
      "input": {
        "iss": "https://publisher.example",
        "aud": "https://agent.example",
        "amt": 1000,
        "cur": "USD",
        "reference": "ch_abc123"
      },
      "expected": {
        "valid": false,
        "error_code": "E_MISSING_REQUIRED_FIELD",
        "error_field": "rail"
      }
    },
    {
      "id": "issue-invalid-009",
      "name": "missing-reference",
      "description": "Missing required reference field",
      "input": {
        "iss": "https://publisher.example",
        "aud": "https://agent.example",
        "amt": 1000,
        "cur": "USD",
        "rail": "stripe"
      },
      "expected": {
        "valid": false,
        "error_code": "E_MISSING_REQUIRED_FIELD",
        "error_field": "reference"
      }
    },
    {
      "id": "issue-invalid-010",
      "name": "empty-issuer",
      "description": "Empty string issuer is invalid",
      "input": {
        "iss": "",
        "aud": "https://agent.example",
        "amt": 1000,
        "cur": "USD",
        "rail": "stripe",
        "reference": "ch_abc123"
      },
      "expected": {
        "valid": false,
        "error_code": "E_INVALID_URL",
        "error_field": "iss"
      }
    }
  ]
}
