{
  "description": "Deterministic Ed25519 JWS golden vectors for @peac/crypto. Seed is SHA-256('peac-golden-vector-001'). These vectors MUST pass across all supported runtimes and library versions.",
  "seed_derivation": "SHA-256('peac-golden-vector-001')",
  "vectors": [
    {
      "name": "basic-receipt",
      "description": "Basic PEAC receipt with Ed25519 signature -- deterministic golden vector",
      "seed_hex": "e14e55866c3659366d386be66bcb7103fb0cfc73b0eb53409d1474168e36943e",
      "public_key_hex": "05460b04b5e62241659e9441f836b2ef69834047d4eaa77bb4e832cbe402bed8",
      "header": {
        "typ": "peac-receipt/0.1",
        "alg": "EdDSA",
        "kid": "golden-001"
      },
      "payload": {
        "iss": "https://golden.example.com",
        "aud": "https://app.example.com",
        "iat": 1700000000,
        "rid": "01930000-0000-7000-8000-000000000001",
        "amt": 500,
        "cur": "USD"
      },
      "jws": "eyJ0eXAiOiJwZWFjLXJlY2VpcHQvMC4xIiwiYWxnIjoiRWREU0EiLCJraWQiOiJnb2xkZW4tMDAxIn0.eyJpc3MiOiJodHRwczovL2dvbGRlbi5leGFtcGxlLmNvbSIsImF1ZCI6Imh0dHBzOi8vYXBwLmV4YW1wbGUuY29tIiwiaWF0IjoxNzAwMDAwMDAwLCJyaWQiOiIwMTkzMDAwMC0wMDAwLTcwMDAtODAwMC0wMDAwMDAwMDAwMDEiLCJhbXQiOjUwMCwiY3VyIjoiVVNEIn0.VEeI7vXfekDQjj23k00VpiD5ivXHQbyd6XRSYisj0hjavZPjKSuywuA6ewkbNKTqejIZlihcJ-0iKSwKrTMACQ",
      "expected_valid": true
    }
  ],
  "negative_vectors": [
    {
      "name": "wrong-public-key",
      "description": "Verification with a different public key must fail",
      "jws": "eyJ0eXAiOiJwZWFjLXJlY2VpcHQvMC4xIiwiYWxnIjoiRWREU0EiLCJraWQiOiJnb2xkZW4tMDAxIn0.eyJpc3MiOiJodHRwczovL2dvbGRlbi5leGFtcGxlLmNvbSIsImF1ZCI6Imh0dHBzOi8vYXBwLmV4YW1wbGUuY29tIiwiaWF0IjoxNzAwMDAwMDAwLCJyaWQiOiIwMTkzMDAwMC0wMDAwLTcwMDAtODAwMC0wMDAwMDAwMDAwMDEiLCJhbXQiOjUwMCwiY3VyIjoiVVNEIn0.VEeI7vXfekDQjj23k00VpiD5ivXHQbyd6XRSYisj0hjavZPjKSuywuA6ewkbNKTqejIZlihcJ-0iKSwKrTMACQ",
      "wrong_public_key_hex": "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",
      "expected_valid": false
    },
    {
      "name": "tampered-payload",
      "description": "Modified payload with original signature must fail",
      "note": "Header and signature from golden vector, but payload has amt changed from 500 to 1",
      "expected_valid": false
    },
    {
      "name": "tampered-signature",
      "description": "Original payload with flipped signature bit must fail",
      "note": "First byte of signature XORed with 0x01",
      "expected_valid": false
    },
    {
      "name": "wrong-typ-header",
      "description": "JWS with wrong typ must be rejected before signature check",
      "expected_valid": false,
      "expected_error": "Invalid typ"
    },
    {
      "name": "wrong-alg-header",
      "description": "JWS with wrong alg must be rejected before signature check",
      "expected_valid": false,
      "expected_error": "Invalid alg"
    },
    {
      "name": "malformed-jws",
      "description": "String without three dot-separated parts must be rejected",
      "jws": "not-a-valid-jws",
      "expected_valid": false,
      "expected_error": "three dot-separated parts"
    }
  ]
}
