{
  "$comment": "Policy document validation golden vectors for cross-language conformance (v0.9.29+)",
  "version": "0.9.29",
  "runner_contract": {
    "parsing": "strict",
    "unknown_fields": "reject",
    "empty_rules": "valid with defaults fallback"
  },
  "valid_fixtures": [
    {
      "id": "policy-valid-001",
      "name": "minimal-policy",
      "description": "Minimal valid policy with one rule",
      "policy": {
        "version": "peac-policy/0.1",
        "rules": [
          {
            "name": "default-deny",
            "decision": "deny"
          }
        ]
      },
      "expected": {
        "valid": true
      }
    },
    {
      "id": "policy-valid-002",
      "name": "full-policy",
      "description": "Policy with all optional fields",
      "policy": {
        "version": "peac-policy/0.1",
        "name": "Full Policy",
        "defaults": {
          "decision": "deny",
          "reason": "Default deny"
        },
        "rules": [
          {
            "name": "allow-all",
            "subject": {
              "type": "human",
              "labels": ["verified"],
              "id": "user:*"
            },
            "purpose": ["crawl", "index"],
            "licensing_mode": ["subscription", "pay_per_crawl"],
            "decision": "allow",
            "reason": "Allow verified humans"
          }
        ]
      },
      "expected": {
        "valid": true
      }
    },
    {
      "id": "policy-valid-003",
      "name": "multiple-rules",
      "description": "Policy with multiple rules",
      "policy": {
        "version": "peac-policy/0.1",
        "rules": [
          {
            "name": "rule-1",
            "decision": "allow"
          },
          {
            "name": "rule-2",
            "decision": "review"
          },
          {
            "name": "rule-3",
            "decision": "deny"
          }
        ]
      },
      "expected": {
        "valid": true
      }
    },
    {
      "id": "policy-valid-004",
      "name": "empty-rules-with-defaults",
      "description": "Empty rules array is valid when defaults are provided - evaluation falls back to defaults.decision",
      "policy": {
        "version": "peac-policy/0.1",
        "defaults": {
          "decision": "deny",
          "reason": "No rules defined"
        },
        "rules": []
      },
      "expected": {
        "valid": true
      }
    }
  ],
  "invalid_fixtures": [
    {
      "id": "policy-invalid-001",
      "name": "wrong-version",
      "description": "Invalid policy version",
      "policy": {
        "version": "peac-policy/0.2",
        "rules": [
          {
            "name": "default",
            "decision": "deny"
          }
        ]
      },
      "expected": {
        "valid": false,
        "error_code": "E_INVALID_POLICY_VERSION"
      }
    },
    {
      "id": "policy-invalid-002",
      "name": "missing-version",
      "description": "Missing required version field",
      "policy": {
        "rules": [
          {
            "name": "default",
            "decision": "deny"
          }
        ]
      },
      "expected": {
        "valid": false,
        "error_code": "E_INVALID_POLICY",
        "error_field": "version"
      }
    },
    {
      "id": "policy-invalid-003",
      "name": "missing-rules",
      "description": "Missing required rules array",
      "policy": {
        "version": "peac-policy/0.1"
      },
      "expected": {
        "valid": false,
        "error_code": "E_INVALID_POLICY",
        "error_field": "rules"
      }
    },
    {
      "id": "policy-invalid-004",
      "name": "invalid-decision",
      "description": "Decision must be allow, deny, or review",
      "policy": {
        "version": "peac-policy/0.1",
        "rules": [
          {
            "name": "invalid",
            "decision": "maybe"
          }
        ]
      },
      "expected": {
        "valid": false,
        "error_code": "E_INVALID_POLICY",
        "error_field": "rules[0].decision"
      }
    },
    {
      "id": "policy-invalid-005",
      "name": "unknown-field",
      "description": "Unknown fields must be rejected (strict parsing)",
      "policy": {
        "version": "peac-policy/0.1",
        "unknown_field": "should fail",
        "rules": [
          {
            "name": "default",
            "decision": "deny"
          }
        ]
      },
      "expected": {
        "valid": false,
        "error_code": "E_INVALID_POLICY",
        "error_field": "unknown_field"
      }
    },
    {
      "id": "policy-invalid-006",
      "name": "rule-missing-name",
      "description": "Rule must have a name",
      "policy": {
        "version": "peac-policy/0.1",
        "rules": [
          {
            "decision": "deny"
          }
        ]
      },
      "expected": {
        "valid": false,
        "error_code": "E_INVALID_POLICY",
        "error_field": "rules[0].name"
      }
    },
    {
      "id": "policy-invalid-007",
      "name": "rule-missing-decision",
      "description": "Rule must have a decision",
      "policy": {
        "version": "peac-policy/0.1",
        "rules": [
          {
            "name": "no-decision"
          }
        ]
      },
      "expected": {
        "valid": false,
        "error_code": "E_INVALID_POLICY",
        "error_field": "rules[0].decision"
      }
    }
  ]
}
