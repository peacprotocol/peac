{
  "$comment": "Invalid WorkflowContext and WorkflowSummaryAttestation vectors (v0.10.2+)",
  "version": "0.10.2",
  "fixtures": [
    {
      "name": "invalid-workflow-id-format",
      "description": "Workflow ID without wf_ prefix",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "step_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "parent_step_ids": []
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_ID_INVALID",
        "error": "Invalid workflow ID format"
      }
    },
    {
      "name": "invalid-step-id-format",
      "description": "Step ID without step_ prefix",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "parent_step_ids": []
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_STEP_ID_INVALID",
        "error": "Invalid step ID format"
      }
    },
    {
      "name": "self-parent-cycle",
      "description": "Step is its own parent (cycle)",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "step_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "parent_step_ids": ["step_01ARZ3NDEKTSV4RRFFQ69G5FAV"]
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_DAG_INVALID",
        "error": "Self-parent cycle detected"
      }
    },
    {
      "name": "duplicate-parents",
      "description": "Duplicate parent step IDs",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "step_01H5KPT9QZA123456789VWXYZG",
        "parent_step_ids": ["step_01ARZ3NDEKTSV4RRFFQ69G5FAV", "step_01ARZ3NDEKTSV4RRFFQ69G5FAV"]
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_DAG_INVALID",
        "error": "Duplicate parent step IDs"
      }
    },
    {
      "name": "too-many-parents",
      "description": "Exceeds maxParentSteps limit (16)",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "step_01H5KPT9QZA123456789VWXYZG",
        "parent_step_ids": [
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA1",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA2",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA3",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA4",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA5",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA6",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA7",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA8",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA9",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F10",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F11",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F12",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F13",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F14",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F15",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F16",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F17"
        ]
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_LIMIT_EXCEEDED",
        "error": "Exceeds maximum parent steps"
      }
    },
    {
      "name": "invalid-hash-format",
      "description": "Invalid prev_receipt_hash format",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "step_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "parent_step_ids": [],
        "prev_receipt_hash": "invalid-hash"
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_CONTEXT_INVALID",
        "error": "Invalid hash format"
      }
    },
    {
      "name": "invalid-framework-grammar",
      "description": "Framework identifier with invalid grammar (uppercase)",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "step_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "parent_step_ids": [],
        "framework": "LangGraph"
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_CONTEXT_INVALID",
        "error": "Invalid framework identifier grammar"
      }
    },
    {
      "name": "framework-with-dot",
      "description": "Framework identifier containing a dot (invalid character)",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "step_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "parent_step_ids": [],
        "framework": "my.framework"
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_CONTEXT_INVALID",
        "error": "Invalid framework identifier grammar"
      }
    },
    {
      "name": "framework-with-slash",
      "description": "Framework identifier containing a slash (invalid character)",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "step_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "parent_step_ids": [],
        "framework": "org/tool"
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_CONTEXT_INVALID",
        "error": "Invalid framework identifier grammar"
      }
    },
    {
      "name": "framework-over-max-length",
      "description": "Framework identifier exceeding 64 character limit (65 chars)",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "step_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "parent_step_ids": [],
        "framework": "abcdefghijklmnopqrstuvwxyz0123456789abcdefghijklmnopqrstuvwxyz01234"
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_CONTEXT_INVALID",
        "error": "Framework identifier exceeds maximum length"
      }
    },
    {
      "name": "extra-unknown-field",
      "description": "Unknown field in strict schema",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "step_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "parent_step_ids": [],
        "unknown_field": "should_fail"
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_CONTEXT_INVALID",
        "error": "Unrecognized keys"
      }
    },
    {
      "name": "summary-wrong-type",
      "description": "Wrong attestation type for workflow summary",
      "type": "WorkflowSummaryAttestation",
      "input": {
        "type": "peac/wrong-type",
        "issuer": "https://orchestrator.example.com",
        "issued_at": "2026-01-20T12:00:00Z",
        "evidence": {
          "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
          "status": "completed",
          "started_at": "2026-01-20T10:00:00Z",
          "receipt_refs": ["jti:receipt1"],
          "orchestrator_id": "agent:orchestrator-001",
          "agents_involved": ["agent:worker-001"]
        }
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_SUMMARY_INVALID",
        "error": "Invalid type"
      }
    },
    {
      "name": "summary-no-receipts-or-merkle",
      "description": "Summary without receipt_refs or receipt_merkle_root",
      "type": "WorkflowSummaryAttestation",
      "input": {
        "type": "peac/workflow-summary",
        "issuer": "https://orchestrator.example.com",
        "issued_at": "2026-01-20T12:00:00Z",
        "evidence": {
          "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
          "status": "completed",
          "started_at": "2026-01-20T10:00:00Z",
          "orchestrator_id": "agent:orchestrator-001",
          "agents_involved": ["agent:worker-001"]
        }
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_SUMMARY_INVALID",
        "error": "Workflow summary must include receipt_refs or receipt_merkle_root"
      }
    },
    {
      "name": "summary-merkle-without-count",
      "description": "Merkle root without receipt_count",
      "type": "WorkflowSummaryAttestation",
      "input": {
        "type": "peac/workflow-summary",
        "issuer": "https://orchestrator.example.com",
        "issued_at": "2026-01-20T12:00:00Z",
        "evidence": {
          "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
          "status": "completed",
          "started_at": "2026-01-20T10:00:00Z",
          "receipt_merkle_root": "sha256:abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789",
          "orchestrator_id": "agent:orchestrator-001",
          "agents_involved": ["agent:worker-001"]
        }
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_SUMMARY_INVALID",
        "error": "receipt_count is required when using receipt_merkle_root"
      }
    },
    {
      "name": "summary-invalid-status",
      "description": "Invalid workflow status",
      "type": "WorkflowSummaryAttestation",
      "input": {
        "type": "peac/workflow-summary",
        "issuer": "https://orchestrator.example.com",
        "issued_at": "2026-01-20T12:00:00Z",
        "evidence": {
          "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
          "status": "pending",
          "started_at": "2026-01-20T10:00:00Z",
          "receipt_refs": ["jti:receipt1"],
          "orchestrator_id": "agent:orchestrator-001",
          "agents_involved": ["agent:worker-001"]
        }
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_SUMMARY_INVALID",
        "error": "Invalid status"
      }
    },
    {
      "name": "summary-http-issuer",
      "description": "Non-HTTPS issuer URL",
      "type": "WorkflowSummaryAttestation",
      "input": {
        "type": "peac/workflow-summary",
        "issuer": "http://insecure.example.com",
        "issued_at": "2026-01-20T12:00:00Z",
        "evidence": {
          "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
          "status": "completed",
          "started_at": "2026-01-20T10:00:00Z",
          "receipt_refs": ["jti:receipt1"],
          "orchestrator_id": "agent:orchestrator-001",
          "agents_involved": ["agent:worker-001"]
        }
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_SUMMARY_INVALID",
        "error": "Issuer must be HTTPS"
      }
    },
    {
      "name": "multi-failure-bad-wfid-and-bad-framework",
      "description": "Multi-failure: invalid workflow_id format AND invalid framework grammar. Per Section 6.5.1, workflow_id format (rule 4) is checked first.",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "INVALID_NO_PREFIX",
        "step_id": "step_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "parent_step_ids": [],
        "framework": "LangGraph"
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_ID_INVALID",
        "error": "Invalid workflow ID format",
        "meta": {
          "validation_order_note": "Required field format (rule 4) before optional field format (rule 6)"
        }
      }
    },
    {
      "name": "multi-failure-bad-stepid-and-too-many-parents",
      "description": "Multi-failure: invalid step_id format AND exceeds parent limit. Per Section 6.5.1, step_id format (rule 5) is checked first.",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "NO_PREFIX_STEP",
        "parent_step_ids": [
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA1",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA2",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA3",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA4",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA5",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA6",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA7",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA8",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA9",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F10",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F11",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F12",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F13",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F14",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F15",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F16",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F17"
        ]
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_STEP_ID_INVALID",
        "error": "Invalid step ID format",
        "meta": {
          "validation_order_note": "Required field format (rule 5) before structural constraint (rule 3)"
        }
      }
    },
    {
      "name": "multi-failure-bad-framework-and-self-parent",
      "description": "Multi-failure: invalid framework grammar AND self-parent cycle. Per Section 6.5.1, framework grammar (rule 6) is checked before DAG semantics (rule 1).",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "step_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "parent_step_ids": ["step_01ARZ3NDEKTSV4RRFFQ69G5FAV"],
        "framework": "UPPER_CASE"
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_CONTEXT_INVALID",
        "error": "Invalid framework identifier grammar",
        "meta": {
          "validation_order_note": "Optional field format (rule 6) before semantic DAG check (rule 1)"
        }
      }
    },
    {
      "name": "multi-failure-too-many-parents-and-bad-hash",
      "description": "Multi-failure: exceeds parent limit AND invalid hash format. Per Section 6.5.1, structural constraint (rule 3) is checked before optional field format (rule 7).",
      "type": "WorkflowContext",
      "input": {
        "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
        "step_id": "step_01H5KPT9QZA123456789VWXYZG",
        "parent_step_ids": [
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA1",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA2",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA3",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA4",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA5",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA6",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA7",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA8",
          "step_01ARZ3NDEKTSV4RRFFQ69G5FA9",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F10",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F11",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F12",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F13",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F14",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F15",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F16",
          "step_01ARZ3NDEKTSV4RRFFQ69G5F17"
        ],
        "prev_receipt_hash": "not-a-valid-hash"
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_LIMIT_EXCEEDED",
        "error": "Exceeds maximum parent steps",
        "meta": {
          "validation_order_note": "Structural constraint (rule 3) before optional field format (rule 7)"
        }
      }
    },
    {
      "name": "error-message-too-long",
      "description": "Error message exceeds maxErrorMessageLength",
      "type": "WorkflowSummaryAttestation",
      "input": {
        "type": "peac/workflow-summary",
        "issuer": "https://orchestrator.example.com",
        "issued_at": "2026-01-20T12:00:00Z",
        "evidence": {
          "workflow_id": "wf_01ARZ3NDEKTSV4RRFFQ69G5FAV",
          "status": "failed",
          "started_at": "2026-01-20T10:00:00Z",
          "receipt_refs": ["jti:receipt1"],
          "orchestrator_id": "agent:orchestrator-001",
          "agents_involved": ["agent:worker-001"],
          "error_context": {
            "failed_step_id": "step_01ARZ3NDEKTSV4RRFFQ69G5FAV",
            "error_code": "E_LONG_ERROR",
            "error_message": "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
          }
        }
      },
      "expected": {
        "valid": false,
        "error_code": "E_WORKFLOW_SUMMARY_INVALID",
        "error": "Error message too long"
      }
    }
  ]
}
