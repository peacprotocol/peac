{
  "$schema": "../vector.schema.json",
  "id": "x402-dos-too-many-accepts",
  "description": "DoS protection: accepts array exceeding MAX_ACCEPT_ENTRIES (128) must fail",
  "category": "invalid",
  "threat_model": "DoS via CPU exhaustion from large accepts arrays. O(n) scan must be bounded.",
  "input": {
    "offer": {
      "payload": {
        "version": "1",
        "validUntil": 9999999999,
        "network": "eip155:8453",
        "asset": "USDC",
        "amount": "100000",
        "payTo": "0x742d35Cc6634C0532925a3b844Bc9e7595f1e123"
      },
      "signature": "0xababababababababababababababababababababababababababababababababcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcdcd1b",
      "format": "eip712"
    },
    "accepts": [
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000001",
        "amount": "1000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000002",
        "amount": "2000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000003",
        "amount": "3000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000004",
        "amount": "4000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000005",
        "amount": "5000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000006",
        "amount": "6000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000007",
        "amount": "7000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000008",
        "amount": "8000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000009",
        "amount": "9000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000000a",
        "amount": "10000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000000b",
        "amount": "11000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000000c",
        "amount": "12000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000000d",
        "amount": "13000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000000e",
        "amount": "14000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000000f",
        "amount": "15000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000010",
        "amount": "16000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000011",
        "amount": "17000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000012",
        "amount": "18000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000013",
        "amount": "19000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000014",
        "amount": "20000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000015",
        "amount": "21000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000016",
        "amount": "22000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000017",
        "amount": "23000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000018",
        "amount": "24000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000019",
        "amount": "25000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000001a",
        "amount": "26000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000001b",
        "amount": "27000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000001c",
        "amount": "28000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000001d",
        "amount": "29000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000001e",
        "amount": "30000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000001f",
        "amount": "31000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000020",
        "amount": "32000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000021",
        "amount": "33000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000022",
        "amount": "34000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000023",
        "amount": "35000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000024",
        "amount": "36000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000025",
        "amount": "37000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000026",
        "amount": "38000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000027",
        "amount": "39000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000028",
        "amount": "40000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000029",
        "amount": "41000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000002a",
        "amount": "42000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000002b",
        "amount": "43000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000002c",
        "amount": "44000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000002d",
        "amount": "45000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000002e",
        "amount": "46000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000002f",
        "amount": "47000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000030",
        "amount": "48000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000031",
        "amount": "49000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000032",
        "amount": "50000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000033",
        "amount": "51000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000034",
        "amount": "52000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000035",
        "amount": "53000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000036",
        "amount": "54000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000037",
        "amount": "55000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000038",
        "amount": "56000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000039",
        "amount": "57000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000003a",
        "amount": "58000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000003b",
        "amount": "59000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000003c",
        "amount": "60000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000003d",
        "amount": "61000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000003e",
        "amount": "62000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000003f",
        "amount": "63000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000040",
        "amount": "64000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000041",
        "amount": "65000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000042",
        "amount": "66000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000043",
        "amount": "67000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000044",
        "amount": "68000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000045",
        "amount": "69000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000046",
        "amount": "70000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000047",
        "amount": "71000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000048",
        "amount": "72000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000049",
        "amount": "73000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000004a",
        "amount": "74000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000004b",
        "amount": "75000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000004c",
        "amount": "76000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000004d",
        "amount": "77000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000004e",
        "amount": "78000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000004f",
        "amount": "79000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000050",
        "amount": "80000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000051",
        "amount": "81000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000052",
        "amount": "82000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000053",
        "amount": "83000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000054",
        "amount": "84000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000055",
        "amount": "85000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000056",
        "amount": "86000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000057",
        "amount": "87000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000058",
        "amount": "88000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000059",
        "amount": "89000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000005a",
        "amount": "90000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000005b",
        "amount": "91000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000005c",
        "amount": "92000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000005d",
        "amount": "93000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000005e",
        "amount": "94000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000005f",
        "amount": "95000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000060",
        "amount": "96000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000061",
        "amount": "97000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000062",
        "amount": "98000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000063",
        "amount": "99000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000064",
        "amount": "100000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000065",
        "amount": "101000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000066",
        "amount": "102000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000067",
        "amount": "103000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000068",
        "amount": "104000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000069",
        "amount": "105000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000006a",
        "amount": "106000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000006b",
        "amount": "107000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000006c",
        "amount": "108000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000006d",
        "amount": "109000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000006e",
        "amount": "110000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000006f",
        "amount": "111000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000070",
        "amount": "112000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000071",
        "amount": "113000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000072",
        "amount": "114000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000073",
        "amount": "115000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000074",
        "amount": "116000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000075",
        "amount": "117000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000076",
        "amount": "118000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000077",
        "amount": "119000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000078",
        "amount": "120000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000079",
        "amount": "121000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000007a",
        "amount": "122000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000007b",
        "amount": "123000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000007c",
        "amount": "124000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000007d",
        "amount": "125000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000007e",
        "amount": "126000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x000000000000000000000000000000000000007f",
        "amount": "127000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000080",
        "amount": "128000000"
      },
      {
        "network": "eip155:8453",
        "asset": "USDC",
        "payTo": "0x0000000000000000000000000000000000000081",
        "amount": "129000000"
      }
    ],
    "acceptIndex": 0
  },
  "expected": {
    "valid": false,
    "errors": [
      {
        "code": "accept_too_many_entries"
      }
    ]
  },
  "notes": "129 entries (exceeds MAX_ACCEPT_ENTRIES=128). The accepts array is generated with unique payTo addresses."
}
