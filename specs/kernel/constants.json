{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "version": "0.9.24",
  "description": "PEAC protocol constants - normative source of truth",
  "wire_format": {
    "type": "peac.receipt/0.9",
    "frozen_until": "v1.0.0",
    "description": "JWT type header value for PEAC receipts"
  },
  "algorithms": {
    "supported": ["EdDSA"],
    "default": "EdDSA",
    "description": "Cryptographic signature algorithms"
  },
  "headers": {
    "receipt": "PEAC-Receipt",
    "purpose": "PEAC-Purpose",
    "purpose_applied": "PEAC-Purpose-Applied",
    "purpose_reason": "PEAC-Purpose-Reason",
    "dpop": "DPoP",
    "description": "HTTP header names for PEAC protocol"
  },
  "purpose": {
    "canonical_tokens": ["train", "search", "user_action", "inference", "index"],
    "internal_only": ["undeclared"],
    "reason_values": [
      "allowed",
      "constrained",
      "denied",
      "downgraded",
      "undeclared_default",
      "unknown_preserved"
    ],
    "limits": {
      "max_token_length": 64,
      "max_tokens_per_request": 10,
      "description": "Purpose header parsing limits (implementation safety, RECOMMENDED)"
    },
    "grammar": {
      "pattern": "^[a-z][a-z0-9_]*(?::[a-z][a-z0-9_]*)?$",
      "description": "Purpose token grammar: lowercase start, alphanumeric/underscore, optional vendor prefix"
    },
    "description": "Purpose vocabulary for PEAC-Purpose header (v0.9.24+)"
  },
  "discovery": {
    "manifest_path": "/.well-known/peac.txt",
    "manifest_version": "peac/0.9",
    "cache_ttl_seconds": 3600,
    "description": "Discovery manifest location and settings"
  },
  "jwks": {
    "rotation_days": 90,
    "overlap_days": 7,
    "emergency_revocation_hours": 24,
    "description": "JWKS rotation and revocation settings"
  },
  "receipt": {
    "min_receipt_id_length": 16,
    "max_receipt_id_length": 64,
    "default_ttl_seconds": 86400,
    "description": "Receipt validation constants"
  },
  "limits": {
    "max_amount_cents": 999999999999,
    "min_amount_cents": 1,
    "description": "Payment amount validation limits"
  },
  "related_specs": {
    "wire_version": "specs/wire/VERSION.json",
    "errors": "specs/kernel/errors.json",
    "registries_doc": "docs/specs/REGISTRIES.md",
    "header_semantics": "docs/specs/PROTOCOL-BEHAVIOR.md#13-http-header-semantics",
    "interop": "docs/specs/INTEROP.md",
    "description": "Related specification documents"
  }
}
